/ext3/miniconda3/envs/torch-env/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/ext3/miniconda3/envs/torch-env/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/ext3/miniconda3/envs/torch-env/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/ext3/miniconda3/envs/torch-env/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/ext3/miniconda3/envs/torch-env/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/ext3/miniconda3/envs/torch-env/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
Some weights of the model checkpoint at models/smiles_pretrain/rxn_pretrain/ were not used when initializing T5ForConditionalGeneration: ['decoder.block.0.layer.1.EncDecAttention.relative_attention_bias.weight']
- This IS expected if you are initializing T5ForConditionalGeneration from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing T5ForConditionalGeneration from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
  0%|          | 0/625500 [00:00<?, ?it/s]  0%|          | 1/625500 [00:01<253:17:37,  1.46s/it]  0%|          | 3/625500 [00:01<182:20:53,  1.05s/it]  0%|          | 5/625500 [00:01<131:35:25,  1.32it/s]  0%|          | 7/625500 [00:01<96:17:00,  1.80it/s]   0%|          | 9/625500 [00:02<71:13:19,  2.44it/s]  0%|          | 11/625500 [00:02<53:58:40,  3.22it/s]  0%|          | 13/625500 [00:02<41:49:45,  4.15it/s]  0%|          | 15/625500 [00:02<33:36:33,  5.17it/s]  0%|          | 17/625500 [00:02<27:27:20,  6.33it/s]  0%|          | 19/625500 [00:02<23:34:22,  7.37it/s]  0%|          | 21/625500 [00:03<20:38:09,  8.42it/s]  0%|          | 23/625500 [00:03<18:59:04,  9.15it/s]  0%|          | 25/625500 [00:03<17:05:31, 10.17it/s]  0%|          | 27/625500 [00:03<15:49:13, 10.98it/s]  0%|          | 29/625500 [00:03<15:03:46, 11.53it/s]  0%|          | 31/625500 [00:03<14:40:27, 11.84it/s]  0%|          | 33/625500 [00:03<13:56:20, 12.46it/s]  0%|          | 35/625500 [00:04<13:36:19, 12.77it/s]  0%|          | 37/625500 [00:04<13:32:55, 12.82it/s]  0%|          | 39/625500 [00:04<13:30:10, 12.87it/s]  0%|          | 41/625500 [00:04<13:24:18, 12.96it/s]  0%|          | 43/625500 [00:04<13:34:14, 12.80it/s]  0%|          | 45/625500 [00:04<14:09:29, 12.27it/s]  0%|          | 47/625500 [00:05<14:06:48, 12.31it/s]  0%|          | 49/625500 [00:05<13:59:19, 12.42it/s]  0%|          | 51/625500 [00:05<13:50:13, 12.56it/s]  0%|          | 53/625500 [00:05<13:47:17, 12.60it/s]  0%|          | 55/625500 [00:05<14:36:04, 11.90it/s]  0%|          | 57/625500 [00:05<14:11:55, 12.24it/s]  0%|          | 59/625500 [00:06<14:10:34, 12.26it/s]  0%|          | 61/625500 [00:06<14:15:26, 12.19it/s]  0%|          | 63/625500 [00:06<14:13:18, 12.22it/s]  0%|          | 65/625500 [00:06<14:01:37, 12.39it/s]  0%|          | 67/625500 [00:06<13:14:00, 13.13it/s]  0%|          | 69/625500 [00:06<13:16:08, 13.09it/s]  0%|          | 71/625500 [00:06<13:14:42, 13.12it/s]  0%|          | 73/625500 [00:07<13:13:07, 13.14it/s]  0%|          | 75/625500 [00:07<13:09:11, 13.21it/s]  0%|          | 77/625500 [00:07<13:14:02, 13.13it/s]  0%|          | 79/625500 [00:07<13:17:25, 13.07it/s]  0%|          | 81/625500 [00:07<13:26:29, 12.92it/s]  0%|          | 83/625500 [00:07<13:44:50, 12.64it/s]  0%|          | 85/625500 [00:08<13:43:38, 12.66it/s]  0%|          | 87/625500 [00:08<13:36:21, 12.77it/s]  0%|          | 89/625500 [00:08<13:38:32, 12.73it/s]  0%|          | 91/625500 [00:08<13:17:03, 13.08it/s]  0%|          | 93/625500 [00:08<13:17:30, 13.07it/s]  0%|          | 95/625500 [00:08<13:27:29, 12.91it/s]  0%|          | 97/625500 [00:09<13:37:07, 12.76it/s]  0%|          | 99/625500 [00:09<13:40:21, 12.71it/s]  0%|          | 101/625500 [00:09<13:34:26, 12.80it/s]  0%|          | 103/625500 [00:09<13:45:50, 12.62it/s]  0%|          | 105/625500 [00:09<13:37:43, 12.75it/s]  0%|          | 107/625500 [00:09<13:45:12, 12.63it/s]  0%|          | 109/625500 [00:09<13:38:12, 12.74it/s]  0%|          | 111/625500 [00:10<14:03:21, 12.36it/s]  0%|          | 113/625500 [00:10<13:40:21, 12.71it/s]  0%|          | 115/625500 [00:10<13:47:28, 12.60it/s]  0%|          | 117/625500 [00:10<13:52:31, 12.52it/s]  0%|          | 119/625500 [00:10<13:30:06, 12.87it/s]  0%|          | 121/625500 [00:10<13:59:54, 12.41it/s]  0%|          | 123/625500 [00:11<14:03:01, 12.36it/s]  0%|          | 125/625500 [00:11<13:53:02, 12.51it/s]  0%|          | 127/625500 [00:11<13:24:16, 12.96it/s]  0%|          | 129/625500 [00:11<13:55:41, 12.47it/s]  0%|          | 131/625500 [00:11<13:32:44, 12.82it/s]  0%|          | 133/625500 [00:11<13:20:41, 13.02it/s]  0%|          | 135/625500 [00:12<13:29:08, 12.88it/s]  0%|          | 137/625500 [00:12<13:33:50, 12.81it/s]  0%|          | 139/625500 [00:12<13:43:00, 12.66it/s]  0%|          | 141/625500 [00:12<13:53:48, 12.50it/s]  0%|          | 143/625500 [00:12<13:36:32, 12.76it/s]  0%|          | 145/625500 [00:12<13:32:14, 12.83it/s]  0%|          | 147/625500 [00:12<13:19:59, 13.03it/s]  0%|          | 149/625500 [00:13<13:27:00, 12.92it/s]  0%|          | 151/625500 [00:13<13:50:49, 12.54it/s]  0%|          | 153/625500 [00:13<13:35:38, 12.78it/s]  0%|          | 155/625500 [00:13<13:38:00, 12.74it/s]  0%|          | 157/625500 [00:13<13:27:55, 12.90it/s]  0%|          | 159/625500 [00:13<13:31:41, 12.84it/s]  0%|          | 161/625500 [00:14<13:11:18, 13.17it/s]  0%|          | 163/625500 [00:14<13:03:52, 13.30it/s]  0%|          | 165/625500 [00:14<13:12:20, 13.15it/s]  0%|          | 167/625500 [00:14<13:20:31, 13.02it/s]  0%|          | 169/625500 [00:14<13:11:44, 13.16it/s]  0%|          | 171/625500 [00:14<13:13:35, 13.13it/s]  0%|          | 173/625500 [00:14<13:30:00, 12.87it/s]  0%|          | 175/625500 [00:15<13:26:21, 12.92it/s]  0%|          | 177/625500 [00:15<13:27:10, 12.91it/s]  0%|          | 179/625500 [00:15<13:32:59, 12.82it/s]  0%|          | 181/625500 [00:15<13:54:29, 12.49it/s]  0%|          | 183/625500 [00:15<13:55:05, 12.48it/s]  0%|          | 185/625500 [00:15<14:08:55, 12.28it/s]  0%|          | 187/625500 [00:16<14:00:53, 12.39it/s]  0%|          | 189/625500 [00:16<14:10:18, 12.26it/s]  0%|          | 191/625500 [00:16<13:59:55, 12.41it/s]  0%|          | 193/625500 [00:16<14:06:43, 12.31it/s]  0%|          | 195/625500 [00:16<13:59:57, 12.41it/s]  0%|          | 197/625500 [00:16<13:56:33, 12.46it/s]  0%|          | 199/625500 [00:17<14:04:48, 12.34it/s]  0%|          | 201/625500 [00:17<13:38:42, 12.73it/s]  0%|          | 203/625500 [00:17<13:46:33, 12.61it/s]  0%|          | 205/625500 [00:17<13:36:41, 12.76it/s]  0%|          | 207/625500 [00:17<13:34:18, 12.80it/s]  0%|          | 209/625500 [00:17<13:38:13, 12.74it/s]  0%|          | 211/625500 [00:17<14:01:46, 12.38it/s]  0%|          | 213/625500 [00:18<14:04:04, 12.35it/s]  0%|          | 215/625500 [00:18<14:03:11, 12.36it/s]  0%|          | 217/625500 [00:18<14:01:30, 12.38it/s]  0%|          | 219/625500 [00:18<13:48:10, 12.58it/s]  0%|          | 221/625500 [00:18<13:38:56, 12.73it/s]  0%|          | 223/625500 [00:18<13:46:43, 12.61it/s]  0%|          | 225/625500 [00:19<13:40:10, 12.71it/s]  0%|          | 227/625500 [00:19<13:27:19, 12.91it/s]  0%|          | 229/625500 [00:19<13:44:46, 12.64it/s]  0%|          | 231/625500 [00:19<13:47:36, 12.59it/s]  0%|          | 233/625500 [00:19<13:46:27, 12.61it/s]  0%|          | 235/625500 [00:19<13:30:06, 12.86it/s]  0%|          | 237/625500 [00:20<13:26:32, 12.92it/s]  0%|          | 239/625500 [00:20<13:30:20, 12.86it/s]  0%|          | 241/625500 [00:20<13:20:47, 13.01it/s]  0%|          | 243/625500 [00:20<13:28:27, 12.89it/s]  0%|          | 245/625500 [00:20<13:20:42, 13.01it/s]  0%|          | 247/625500 [00:20<13:07:44, 13.23it/s]  0%|          | 249/625500 [00:20<13:05:44, 13.26it/s]  0%|          | 251/625500 [00:21<13:12:47, 13.14it/s]  0%|          | 253/625500 [00:21<13:10:19, 13.19it/s]  0%|          | 255/625500 [00:21<13:24:47, 12.95it/s]  0%|          | 257/625500 [00:21<13:08:41, 13.21it/s]  0%|          | 259/625500 [00:21<13:27:52, 12.90it/s]  0%|          | 261/625500 [00:21<13:25:04, 12.94it/s]  0%|          | 263/625500 [00:22<13:28:41, 12.89it/s]  0%|          | 265/625500 [00:22<13:03:59, 13.29it/s]  0%|          | 267/625500 [00:22<14:26:35, 12.02it/s]  0%|          | 269/625500 [00:22<13:54:30, 12.49it/s]  0%|          | 271/625500 [00:22<14:03:21, 12.36it/s]  0%|          | 273/625500 [00:22<13:47:54, 12.59it/s]  0%|          | 275/625500 [00:22<13:42:57, 12.66it/s]  0%|          | 277/625500 [00:23<13:56:59, 12.45it/s]  0%|          | 279/625500 [00:23<13:39:59, 12.71it/s]  0%|          | 281/625500 [00:23<13:41:34, 12.68it/s]  0%|          | 283/625500 [00:23<13:22:33, 12.98it/s]  0%|          | 285/625500 [00:23<13:35:52, 12.77it/s]  0%|          | 287/625500 [00:23<13:14:34, 13.11it/s]  0%|          | 289/625500 [00:24<13:20:13, 13.02it/s]  0%|          | 291/625500 [00:24<13:23:24, 12.97it/s]  0%|          | 293/625500 [00:24<13:33:08, 12.81it/s]  0%|          | 295/625500 [00:24<13:36:22, 12.76it/s]  0%|          | 297/625500 [00:24<13:33:35, 12.81it/s]  0%|          | 299/625500 [00:24<13:55:20, 12.47it/s]  0%|          | 301/625500 [00:25<13:55:40, 12.47it/s]  0%|          | 303/625500 [00:25<13:46:18, 12.61it/s]  0%|          | 305/625500 [00:25<13:36:42, 12.76it/s]  0%|          | 307/625500 [00:25<13:42:01, 12.68it/s]  0%|          | 309/625500 [00:25<13:40:52, 12.69it/s]  0%|          | 311/625500 [00:25<14:06:12, 12.31it/s]  0%|          | 313/625500 [00:25<13:47:08, 12.60it/s]  0%|          | 315/625500 [00:26<13:50:45, 12.54it/s]  0%|          | 317/625500 [00:26<13:44:41, 12.63it/s]  0%|          | 319/625500 [00:26<13:27:16, 12.91it/s]  0%|          | 321/625500 [00:26<13:33:34, 12.81it/s]  0%|          | 323/625500 [00:26<13:44:44, 12.63it/s]  0%|          | 325/625500 [00:26<13:46:12, 12.61it/s]  0%|          | 327/625500 [00:27<14:03:50, 12.35it/s]  0%|          | 329/625500 [00:27<13:22:36, 12.98it/s]  0%|          | 331/625500 [00:27<13:45:35, 12.62it/s]  0%|          | 333/625500 [00:27<13:45:12, 12.63it/s]  0%|          | 335/625500 [00:27<14:28:38, 11.99it/s]  0%|          | 337/625500 [00:27<14:03:06, 12.36it/s]  0%|          | 339/625500 [00:28<14:01:45, 12.38it/s]  0%|          | 341/625500 [00:28<13:54:09, 12.49it/s]  0%|          | 343/625500 [00:28<13:50:13, 12.55it/s]  0%|          | 345/625500 [00:28<14:04:51, 12.33it/s]  0%|          | 347/625500 [00:28<13:54:22, 12.49it/s]  0%|          | 349/625500 [00:28<13:41:42, 12.68it/s]  0%|          | 351/625500 [00:29<13:43:19, 12.66it/s]  0%|          | 353/625500 [00:29<13:43:30, 12.65it/s]  0%|          | 355/625500 [00:29<13:51:01, 12.54it/s]  0%|          | 357/625500 [00:29<13:49:37, 12.56it/s]  0%|          | 359/625500 [00:29<13:37:32, 12.74it/s]  0%|          | 361/625500 [00:29<13:42:39, 12.67it/s]  0%|          | 363/625500 [00:29<13:58:19, 12.43it/s]  0%|          | 365/625500 [00:30<14:06:03, 12.31it/s]  0%|          | 367/625500 [00:30<13:59:00, 12.42it/s]  0%|          | 369/625500 [00:30<14:32:20, 11.94it/s]  0%|          | 371/625500 [00:30<14:17:36, 12.15it/s]  0%|          | 373/625500 [00:30<14:43:57, 11.79it/s]  0%|          | 375/625500 [00:30<14:19:53, 12.12it/s]  0%|          | 377/625500 [00:31<14:13:26, 12.21it/s]  0%|          | 379/625500 [00:31<14:10:23, 12.25it/s]  0%|          | 381/625500 [00:31<14:01:08, 12.39it/s]  0%|          | 383/625500 [00:31<13:49:33, 12.56it/s]  0%|          | 385/625500 [00:31<13:39:44, 12.71it/s]  0%|          | 387/625500 [00:31<13:59:25, 12.41it/s]  0%|          | 389/625500 [00:32<14:12:39, 12.22it/s]  0%|          | 391/625500 [00:32<14:11:50, 12.23it/s]  0%|          | 393/625500 [00:32<13:48:39, 12.57it/s]  0%|          | 395/625500 [00:32<14:00:07, 12.40it/s]  0%|          | 397/625500 [00:32<13:53:30, 12.50it/s]  0%|          | 399/625500 [00:32<13:53:05, 12.51it/s]  0%|          | 401/625500 [00:33<13:52:26, 12.52it/s]  0%|          | 403/625500 [00:33<13:34:40, 12.79it/s]  0%|          | 405/625500 [00:33<13:23:20, 12.97it/s]  0%|          | 407/625500 [00:33<13:46:24, 12.61it/s]  0%|          | 409/625500 [00:33<13:20:20, 13.02it/s]  0%|          | 411/625500 [00:33<13:43:24, 12.65it/s]  0%|          | 413/625500 [00:34<14:06:37, 12.31it/s]  0%|          | 415/625500 [00:34<13:48:24, 12.58it/s]  0%|          | 417/625500 [00:34<14:17:55, 12.14it/s]  0%|          | 419/625500 [00:34<13:53:18, 12.50it/s]  0%|          | 421/625500 [00:34<13:30:11, 12.86it/s]  0%|          | 423/625500 [00:34<13:38:54, 12.72it/s]  0%|          | 425/625500 [00:34<13:35:59, 12.77it/s]  0%|          | 427/625500 [00:35<13:50:17, 12.55it/s]  0%|          | 429/625500 [00:35<13:52:07, 12.52it/s]  0%|          | 431/625500 [00:35<13:32:35, 12.82it/s]  0%|          | 433/625500 [00:35<13:42:31, 12.67it/s]  0%|          | 435/625500 [00:35<14:01:25, 12.38it/s]  0%|          | 437/625500 [00:35<13:54:39, 12.48it/s]  0%|          | 439/625500 [00:36<13:39:06, 12.72it/s]  0%|          | 441/625500 [00:36<14:35:01, 11.91it/s]  0%|          | 443/625500 [00:36<14:06:45, 12.30it/s]  0%|          | 445/625500 [00:36<13:46:48, 12.60it/s]  0%|          | 447/625500 [00:36<13:45:19, 12.62it/s]  0%|          | 449/625500 [00:36<13:32:29, 12.82it/s]  0%|          | 451/625500 [00:37<13:23:31, 12.96it/s]  0%|          | 453/625500 [00:37<13:05:35, 13.26it/s]  0%|          | 455/625500 [00:37<13:02:33, 13.31it/s]  0%|          | 457/625500 [00:37<13:09:35, 13.19it/s]  0%|          | 459/625500 [00:37<13:08:46, 13.21it/s]  0%|          | 461/625500 [00:37<13:04:27, 13.28it/s]  0%|          | 463/625500 [00:37<13:06:13, 13.25it/s]  0%|          | 465/625500 [00:38<13:22:07, 12.99it/s]  0%|          | 467/625500 [00:38<13:03:36, 13.29it/s]  0%|          | 469/625500 [00:38<12:53:28, 13.47it/s]  0%|          | 471/625500 [00:38<13:15:25, 13.10it/s]  0%|          | 473/625500 [00:38<13:01:46, 13.33it/s]  0%|          | 475/625500 [00:38<13:18:11, 13.05it/s]  0%|          | 477/625500 [00:38<13:41:39, 12.68it/s]  0%|          | 479/625500 [00:39<13:54:53, 12.48it/s]  0%|          | 481/625500 [00:39<14:01:00, 12.39it/s]  0%|          | 483/625500 [00:39<13:48:02, 12.58it/s]  0%|          | 485/625500 [00:39<13:32:55, 12.81it/s]  0%|          | 487/625500 [00:39<14:18:21, 12.14it/s]  0%|          | 489/625500 [00:39<14:06:33, 12.31it/s]  0%|          | 491/625500 [00:40<13:39:08, 12.72it/s]  0%|          | 493/625500 [00:40<13:38:52, 12.72it/s]  0%|          | 495/625500 [00:40<13:58:43, 12.42it/s]  0%|          | 497/625500 [00:40<14:08:16, 12.28it/s]  0%|          | 499/625500 [00:40<14:12:06, 12.22it/s]                                                         0%|          | 500/625500 [00:40<14:12:05, 12.22it/s]
  0%|          | 0/157 [00:00<?, ?it/s][A{'loss': 0.38910955810546877, 'learning_rate': 0.0004996003197442046, 'epoch': 0.3996802557953637}
Traceback (most recent call last):
  File "src/run_trainer.py", line 259, in <module>
    main()
  File "src/run_trainer.py", line 250, in main
    trainer.train()
  File "/ext3/miniconda3/envs/torch-env/lib/python3.7/site-packages/transformers-4.0.1-py3.8.egg/transformers/trainer.py", line 777, in train
  File "/ext3/miniconda3/envs/torch-env/lib/python3.7/site-packages/transformers-4.0.1-py3.8.egg/transformers/trainer.py", line 844, in _maybe_log_save_evaluate
  File "/scratch/jl8570/rxntransformer/src/models/Trainer.py", line 29, in evaluate
    ignore_keys=ignore_keys,
  File "/scratch/jl8570/rxntransformer/src/models/Trainer.py", line 90, in prediction_loop
    preds_host = logits if preds_host is None else nested_concat(preds_host, logits, padding_index=-100)
NameError: name 'nested_concat' is not defined
  0%|          | 500/625500 [00:41<14:16:54, 12.16it/s]

                                       [A/ext3/miniconda3/envs/torch-env/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/ext3/miniconda3/envs/torch-env/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/ext3/miniconda3/envs/torch-env/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/ext3/miniconda3/envs/torch-env/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/ext3/miniconda3/envs/torch-env/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/ext3/miniconda3/envs/torch-env/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
file models/USPTO_50k/EMA_can/config.json not found
Traceback (most recent call last):
  File "/ext3/miniconda3/envs/torch-env/lib/python3.7/site-packages/transformers-4.0.1-py3.8.egg/transformers/configuration_utils.py", line 386, in get_config_dict
  File "/ext3/miniconda3/envs/torch-env/lib/python3.7/site-packages/transformers-4.0.1-py3.8.egg/transformers/file_utils.py", line 1014, in cached_path
OSError: file models/USPTO_50k/EMA_can/config.json not found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "src/run_predict.py", line 161, in <module>
    main()
  File "src/run_predict.py", line 127, in main
    model = T5ForConditionalGeneration.from_pretrained(args.model_dir).to(device)
  File "/ext3/miniconda3/envs/torch-env/lib/python3.7/site-packages/transformers-4.0.1-py3.8.egg/transformers/modeling_utils.py", line 877, in from_pretrained
  File "/ext3/miniconda3/envs/torch-env/lib/python3.7/site-packages/transformers-4.0.1-py3.8.egg/transformers/configuration_utils.py", line 345, in from_pretrained
  File "/ext3/miniconda3/envs/torch-env/lib/python3.7/site-packages/transformers-4.0.1-py3.8.egg/transformers/configuration_utils.py", line 398, in get_config_dict
OSError: Can't load config for 'models/USPTO_50k/EMA_can/'. Make sure that:

- 'models/USPTO_50k/EMA_can/' is a correct model identifier listed on 'https://huggingface.co/models'

- or 'models/USPTO_50k/EMA_can/' is the correct path to a directory containing a config.json file


evaluating models/USPTO_50k/EMA_can/predictions.csv
Traceback (most recent call last):
  File "src/evaluate_predictions.py", line 75, in <module>
    main()
  File "src/evaluate_predictions.py", line 43, in main
    predictions = pd.read_csv(args.prediction)
  File "/ext3/miniconda3/envs/torch-env/lib/python3.7/site-packages/pandas/io/parsers.py", line 685, in parser_f
    return _read(filepath_or_buffer, kwds)
  File "/ext3/miniconda3/envs/torch-env/lib/python3.7/site-packages/pandas/io/parsers.py", line 457, in _read
    parser = TextFileReader(fp_or_buf, **kwds)
  File "/ext3/miniconda3/envs/torch-env/lib/python3.7/site-packages/pandas/io/parsers.py", line 895, in __init__
    self._make_engine(self.engine)
  File "/ext3/miniconda3/envs/torch-env/lib/python3.7/site-packages/pandas/io/parsers.py", line 1135, in _make_engine
    self._engine = CParserWrapper(self.f, **self.options)
  File "/ext3/miniconda3/envs/torch-env/lib/python3.7/site-packages/pandas/io/parsers.py", line 1906, in __init__
    self._reader = parsers.TextReader(src, **kwds)
  File "pandas/_libs/parsers.pyx", line 380, in pandas._libs.parsers.TextReader.__cinit__
  File "pandas/_libs/parsers.pyx", line 687, in pandas._libs.parsers.TextReader._setup_parser_source
FileNotFoundError: [Errno 2] File b'models/USPTO_50k/EMA_can/predictions.csv' does not exist: b'models/USPTO_50k/EMA_can/predictions.csv'
